---
title: 代理与AOP
date: 2018-10-17 09:58:53
categories:
- 设计模式
tags:
- 代理模式
- 动态代理
- AOP
---

# 代理

代理模式是一种设计模式，提供了对目标对象额外的访问方式，即通过代理对象访问目标对象，这样可以在不修改原目标对象的前提下，提供额外的功能操作，扩展目标对象的功能。简言之，代理模式就是设置一个中间代理来控制访问原目标对象，以达到增强原对象的功能和简化访问方式。

举个例子，我们生活中经常到火车站去买车票，但是人一多的话，就会非常拥挤，于是就有了代售点，我们能从代售点买车票了。这其中就是代理模式的体现，代售点代理了火车站对象，提供购买车票的方法。

## 静态代理

这种代理方式需要代理对象和目标对象实现一样的接口。

![](代理/UML.png)

### 角色

- Subject：被代理的接口，定义了方法DoAction()；

  ```java
  public interface Subject {
  
      void doAction();
  
  }
  ```

- RealSubject：原对象，真正的业务实现类，实现了Subject接口；

  ```java
  public class RealSubject implements Subject {
  
      @Override
      public void doAction() {
          System.out.println("RealSubject is doing...");
      }
  
  }
  ```

- Proxy：代理类，代理原对象，实现了Subject接口。

  ```java
  public class Proxy implements Subject {
  
      private RealSubject subject;
  
      public Proxy(RealSubject subject) {
          this.subject = subject;
      }
  
      @Override
      public void doAction() {
          System.out.println("Proxy is doing before");
          subject.doAction();
          System.out.println("Proxy is doing after");
      }
  
  }
  ```

### 优劣

#### 优点

- 可以在不修改目标对象的前提下扩展目标对象的功能。

#### 缺点

- 冗余，由于代理对象要实现与目标对象一致的接口，会产生过多的代理类；
- 不易维护，一旦接口增加方法，目标对象与代理对象都要进行修改。

## 动态代理

动态代理是在实现阶段不用关心代理谁，而在运行阶段才动态的指定代理哪一个对象。

### jdk

### cglib

# AOP